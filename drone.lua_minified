local a,b,c=computer,table,string;function sleep(d)local e=a.uptime()+(d or 0)repeat a.pullSignal(e-a.uptime())until a.uptime()>=e end;function part(f)return component.proxy(component.list(f)())end;local g="https://raw.githubusercontent.com/devomaa/oc-drone/master/"chat=part"chat"radar=part"radar"drone=part"drone"cam=part"camera"nav=part"navigation"interweb=part"internet"bios=part"eeprom"local h=g.."drone.lua_minified"local i=g.."drone_extras.lua"local j,k=chat.say,drone.setStatusText;k"Bound"function read_keys()if bios.getData()==""then bios.setData("{}")end;return load("return "..bios.getData())()end;function key_exists(l)data=read_keys()if data[l]then return true end;return false end;function read_key(l)return read_keys()[l]end;function store_table(m)local n="{"for o,p in pairs(m)do n=n..o.."="..c.format("%q",p)..","end;bios.setData(n.."}")end;function store_key(l,q)local data=read_keys()data[l]=q;store_table(data)end;sleep()a.beep(2000)k"Init"function net_get(r)local s=interweb.request(r)k"Updating"s.finishConnect()k"Connected"local t=""while true do k"Processing"local u=s.read()if u then c.gsub(u,"\r\n","\n")t=t..u else break end end;return t end;local v=net_get(h)if v~=""then k"Flashing"local w=bios.getChecksum()bios.set(v)local x=bios.getChecksum()if w~=x then a.shutdown(true)end end;k"Configuring"sleep()k"Coro init"local y=coroutine.resume;local z={}function register_coro(A,B)b.insert(z,{thread=coroutine.create(A),event=B})end;k"Downloading"load(net_get(i)or"")()while true do local C={a.pullSignal(0.001)}for D,E in pairs(z)do local F=E["thread"]local G=coroutine.status(F)if G=="dead"then b.remove(z,D)k":(           "j("Error in coroutine "..D)end;if E["event"]then if C then y(F,b.unpack(C))end else y(F)end end end
